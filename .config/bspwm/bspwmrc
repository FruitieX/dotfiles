#! /bin/zsh
#unset DBUS_SESSION_BUS_ADDRESS
#
export BSPWM_TREE=/tmp/bspwm.tree
export BSPWM_HISTORY=/tmp/bspwm.history
export BSPWM_STACK=/tmp/bspwm.stack

killall -9 sxhkd compton
export BSPWM_SOCKET=/tmp/bspwm-socket
sxhkd -c ~/.config/bspwm/sxhkdrc &
compton --config ~/.compton.conf &

i=1
NUM_DESKTOPS=6
for monitor in $(bspc query -M); do
	bspc monitor "$monitor" -d $i
	i=$((i+1))
done

for desktop in $(seq $i $NUM_DESKTOPS); do
	#bspc monitor primary -a $desktop # THIS SEGFAULTS on one monitor!
	bspc monitor focused -a $desktop
done

bspc rule -a Steam -d 5
bspc rule -a Firefox -d 2
#--follow
#
#bspc rule -a BSPWM_FRAME --frame
#bspc config normal_frame_opacity 0

bspc config split_ratio             0.50
bspc config border_width            1
bspc config window_gap              30
bspc config borderless_monocle      true
bspc config gapless_monocle         true
bspc config auto_cancel 			true
bspc config normal_border_color     "#181512"
bspc config focused_border_color    "#88ada9"
bspc config presel_border_color     "#d87d79"

if [ -e "$BSPWM_TREE" ] ; then
	bspc restore -T "$BSPWM_TREE" -H "$BSPWM_HISTORY" -S "$BSPWM_STACK"
	rm "$BSPWM_TREE" "$BSPWM_HISTORY" "$BSPWM_STACK"
fi
